<view class="container">
  <!-- é¡¶éƒ¨ï¼šæœç´¢ä¸Žæ¨¡åž‹æŽ¨è -->
  <view class="top-bar">
    <view class="search-bar">
      <input
        class="search-input"
        type="text"
        placeholder="{{lang.index_search}}"
        value="{{searchValue}}"
        bindinput="onSearchChange"
      />
      <button class="search-button" bindtap="searchDishes">{{lang.index_search_btn}}</button>
      <button class="model-recommend-button" bindtap="goToModelRecommend">ðŸ¤– {{lang.index_model}}</button>
    </view>
  </view>

  <!-- èœå•æ  -->
  <view class="menu-bar">
    <picker mode="selector" range="{{sortOptions}}" range-key="text" bindchange="onSortPickerChange">
      <view class="picker-item">{{lang.index_sort_by}}ï¼š{{sortOptions[selectedSortOptionIndex].text}}</view>
    </picker>
    <picker mode="multiSelector" range="{{filterTags}}" bindchange="onFilterChange">
      <view class="picker-item">
        {{lang.index_more_rules}}ï¼š
        {{selectedFilterTags.length > 0 ? selectedFilterTags.join('ï¼Œ') : lang.index_all}}
      </view>
    </picker>
  </view>

  <!-- èœå“åˆ—è¡¨ -->
  <view class="menu-list">
    <block wx:for="{{dishes}}" wx:key="index">
      <view class="dish-card">
        <!-- å›¾ç‰‡ + ä¿¡æ¯ -->
        <view class="dish-info">
          <image
            src="{{item.image}}"
            class="menu-image"
            mode="aspectFill"
            binderror="handleImageError"
            data-index="{{index}}"
          />
          <view class="menu-text">
            <view class="menu-name">{{item.name}}</view>
            <view class="rating-and-number">
              <view class="menu-rating">
                <block wx:for="{{item.stars}}" wx:key="starIndex" wx:for-item="star">
                  <text class="{{star === 'active' ? 'star-rated' : 'star-unrated'}}">â˜…</text>
                </block>
              </view>
              <view class="original-rating">({{item.averageRating}})</view>
            </view>
            <view class="menu-price">{{item.price}}{{lang.currency_unit}}</view>
            <view class="menu-description">{{item.description}}</view>
          </view>
        </view>

        <!-- è¯„åˆ†æŒ‰é’®åŒºåŸŸ -->
        <view class="dish-bottom">
          <view class="button-group">
            <button
              class="rating-button"
              data-id="{{item._id}}"
              bindtap="onDishClick"
            >{{lang.index_rate}}</button>
          </view>
        </view>
      </view>
    </block>
  </view>
</view>
